<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="ProDraw">
  <title>ProDraw ‚Äî iPad Drawing Studio</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<header id="toolbar-top">
  <div class="toolbar-group">
    <button class="tool-btn" id="btn-new" title="New Canvas">
      <svg viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
    </button>
    <button class="tool-btn" id="btn-save" title="Save PNG">
      <svg viewBox="0 0 24 24"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
    </button>
    <button class="tool-btn" id="btn-export-jpg" title="Export JPG">JPG</button>
    <button class="tool-btn" id="btn-undo" title="Undo">
      <svg viewBox="0 0 24 24"><polyline points="9 14 4 9 9 4"/><path d="M20 20v-7a4 4 0 0 0-4-4H4"/></svg>
    </button>
    <button class="tool-btn" id="btn-redo" title="Redo">
      <svg viewBox="0 0 24 24"><polyline points="15 14 20 9 15 4"/><path d="M4 20v-7a4 4 0 0 0 4-4h12"/></svg>
    </button>
  </div>

  <div class="toolbar-group" id="canvas-controls">
    <button class="tool-btn" id="btn-zoom-out">‚àí</button>
    <span id="zoom-label">100%</span>
    <button class="tool-btn" id="btn-zoom-in">+</button>
    <button class="tool-btn" id="btn-fit" title="Fit">‚ä°</button>
    <button class="tool-btn" id="btn-rotate-cw" title="Rotate CW">‚Üª</button>
    <button class="tool-btn" id="btn-rotate-ccw" title="Rotate CCW">‚Ü∫</button>
  </div>

  <div class="toolbar-group">
    <button class="tool-btn toggle-btn" id="btn-symmetry" title="Symmetry">‚áî</button>
    <button class="tool-btn toggle-btn" id="btn-grid" title="Grid">‚äû</button>
    <button class="tool-btn toggle-btn" id="btn-reference" title="Reference">üì∑</button>
    <button class="tool-btn toggle-btn" id="btn-layers-toggle" title="Layers">‚äï</button>
    <button class="tool-btn" id="btn-fullscreen" title="Fullscreen">‚õ∂</button>
  </div>
</header>

<aside id="toolbar-left">
  <button class="tool-btn tool-select active" data-tool="brush" title="Brush (B)">
    <svg viewBox="0 0 24 24"><path d="M12 19l7-7 3 3-7 7-3-3z"/><path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/><circle cx="11" cy="11" r="2"/></svg>
  </button>
  <button class="tool-btn tool-select" data-tool="pencil" title="Pencil (P)">
    <svg viewBox="0 0 24 24"><line x1="18" y1="2" x2="22" y2="6"/><path d="M7.5 20.5 19 9l-4-4L3.5 16.5 2 22z"/></svg>
  </button>
  <button class="tool-btn tool-select" data-tool="pen" title="Pen (I)">
    <svg viewBox="0 0 24 24"><path d="m12 19 7-7 3 3-7 7-3-3z"/><path d="m18 13-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/></svg>
  </button>
  <button class="tool-btn tool-select" data-tool="marker" title="Marker (M)">
    <svg viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="6" rx="2"/><path d="m16 3 5 5-8 3-5-5 8-3z"/></svg>
  </button>
  <button class="tool-btn tool-select" data-tool="watercolor" title="Watercolor (W)">
    <svg viewBox="0 0 24 24"><path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"/></svg>
  </button>
  <button class="tool-btn tool-select" data-tool="airbrush" title="Airbrush (A)">
    <svg viewBox="0 0 24 24"><circle cx="9" cy="12" r="5"/><path d="M14 12h7"/><path d="M17 9v6"/></svg>
  </button>
  <button class="tool-btn tool-select" data-tool="smudge" title="Smudge (S)">
    <svg viewBox="0 0 24 24"><path d="M3 3c3 6 12 6 12 12s-9 6-12 12"/><path d="M21 3c-3 6-12 6-12 12s9 6 12 12"/></svg>
  </button>
  <button class="tool-btn tool-select" data-tool="eraser" title="Eraser (E)">
    <svg viewBox="0 0 24 24"><path d="m20 20-6.04-6.04"/><path d="M6.4 6.4 2 22l5.5-2.5L22 6l-5-5L6.4 6.4z"/></svg>
  </button>
  <button class="tool-btn tool-select" data-tool="fill" title="Fill (F)">
    <svg viewBox="0 0 24 24"><path d="m19 11-8-8-8.5 8.5a5.5 5.5 0 0 0 7.78 7.78L19 11Z"/><path d="m3.5 11.5 7 7"/></svg>
  </button>
  <button class="tool-btn tool-select" data-tool="eyedropper" title="Eyedropper (K)">
    <svg viewBox="0 0 24 24"><path d="m2 22 1-1h3l9-9"/><path d="M3 21v-3l9-9"/><path d="m15 6 3.4-3.4a2.1 2.1 0 1 1 3 3L18 9l.4.4a2.1 2.1 0 1 1-3 3l-3.8-3.8Z"/></svg>
  </button>
  <button class="tool-btn tool-select" data-tool="lasso" title="Lasso (L)">
    <svg viewBox="0 0 24 24"><path d="M7 22a5 5 0 0 1-2-4"/><path d="M3.34 14A6.8 6.8 0 0 1 2 10c0-4.42 4.48-8 10-8s10 3.58 10 8a7.19 7.19 0 0 1-.33 2"/><circle cx="5" cy="18" r="2"/></svg>
  </button>
  <button class="tool-btn tool-select" data-tool="transform" title="Transform (T)">
    <svg viewBox="0 0 24 24"><path d="M5 3 3 5"/><path d="M9 3H5v4"/><path d="m15 3 2 2"/><path d="M19 3h-4v4"/><path d="m5 21-2-2"/><path d="M9 21H5v-4"/><path d="m15 21 2-2"/><path d="M19 21h-4v-4"/></svg>
  </button>
  <button class="tool-btn tool-select" data-tool="shape" title="Shapes (H)">
    <svg viewBox="0 0 24 24"><rect x="3" y="3" width="8" height="8"/><circle cx="17" cy="7" r="4"/><polygon points="12 21 3 21 7.5 13"/></svg>
  </button>
  <button class="tool-btn tool-select" data-tool="text" title="Text (X)">
    <svg viewBox="0 0 24 24"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" y1="20" x2="15" y2="20"/><line x1="12" y1="4" x2="12" y2="20"/></svg>
  </button>

  <div class="left-separator"></div>
  <div id="quick-colors">
    <div class="q-color" style="background:#000" data-color="#000000"></div>
    <div class="q-color" style="background:#fff;border:1px solid #444" data-color="#ffffff"></div>
    <div class="q-color" style="background:#e74c3c" data-color="#e74c3c"></div>
    <div class="q-color" style="background:#3498db" data-color="#3498db"></div>
    <div class="q-color" style="background:#2ecc71" data-color="#2ecc71"></div>
    <div class="q-color" style="background:#f39c12" data-color="#f39c12"></div>
    <div class="q-color" style="background:#9b59b6" data-color="#9b59b6"></div>
    <div class="q-color" style="background:#1abc9c" data-color="#1abc9c"></div>
  </div>
</aside>

<aside id="panel-right">
  <div id="panel-tabs">
    <button class="panel-tab active" data-panel="brush-panel">Brush</button>
    <button class="panel-tab" data-panel="color-panel">Color</button>
    <button class="panel-tab" data-panel="layers-panel">Layers</button>
    <button class="panel-tab" data-panel="reference-panel">Ref</button>
  </div>

  <!-- BRUSH PANEL -->
  <div id="brush-panel" class="panel-content active">
    <div class="panel-section">
      <label>Size <span id="size-val">20</span>px</label>
      <input type="range" id="brush-size" min="1" max="300" value="20">
    </div>
    <div class="panel-section">
      <label>Opacity <span id="opacity-val">100</span>%</label>
      <input type="range" id="brush-opacity" min="1" max="100" value="100">
    </div>
    <div class="panel-section">
      <label>Hardness <span id="hardness-val">80</span>%</label>
      <input type="range" id="brush-hardness" min="0" max="100" value="80">
    </div>
    <div class="panel-section">
      <label>Flow <span id="flow-val">100</span>%</label>
      <input type="range" id="brush-flow" min="1" max="100" value="100">
    </div>
    <div class="panel-section">
      <label>Spacing <span id="spacing-val">10</span>%</label>
      <input type="range" id="brush-spacing" min="1" max="200" value="10">
    </div>
    <div class="panel-section">
      <label>Angle <span id="angle-val">0</span>¬∞</label>
      <input type="range" id="brush-angle" min="0" max="360" value="0">
    </div>
    <div class="panel-section">
      <label>Roundness <span id="roundness-val">100</span>%</label>
      <input type="range" id="brush-roundness" min="10" max="100" value="100">
    </div>
    <div class="panel-section toggle-row">
      <label>Pressure ‚Üí Size</label>
      <label class="switch"><input type="checkbox" id="pressure-size" checked><span class="slider-sw"></span></label>
    </div>
    <div class="panel-section toggle-row">
      <label>Pressure ‚Üí Opacity</label>
      <label class="switch"><input type="checkbox" id="pressure-opacity" checked><span class="slider-sw"></span></label>
    </div>
    <div class="panel-section toggle-row">
      <label>Tilt ‚Üí Texture</label>
      <label class="switch"><input type="checkbox" id="tilt-texture"><span class="slider-sw"></span></label>
    </div>
    <div class="panel-section toggle-row">
      <label>Stabilizer</label>
      <label class="switch"><input type="checkbox" id="stabilizer"><span class="slider-sw"></span></label>
    </div>
    <div class="panel-section" id="stabilizer-section" style="display:none">
      <label>Smooth <span id="smooth-val">50</span>%</label>
      <input type="range" id="brush-smooth" min="0" max="100" value="50">
    </div>
    <div class="panel-section">
      <label>Blend Mode</label>
      <select id="blend-mode">
        <option value="source-over">Normal</option>
        <option value="multiply">Multiply</option>
        <option value="screen">Screen</option>
        <option value="overlay">Overlay</option>
        <option value="soft-light">Soft Light</option>
        <option value="hard-light">Hard Light</option>
        <option value="color-dodge">Color Dodge</option>
        <option value="color-burn">Color Burn</option>
        <option value="darken">Darken</option>
        <option value="lighten">Lighten</option>
        <option value="difference">Difference</option>
        <option value="exclusion">Exclusion</option>
        <option value="hue">Hue</option>
        <option value="saturation">Saturation</option>
        <option value="color">Color</option>
        <option value="luminosity">Luminosity</option>
      </select>
    </div>
    <div class="panel-section">
      <label>Presets</label>
      <div id="brush-presets">
        <div class="brush-preset active" data-preset="basic" title="Basic Round">‚óè</div>
        <div class="brush-preset" data-preset="soft" title="Soft">‚óâ</div>
        <div class="brush-preset" data-preset="rough" title="Rough">‚ú¶</div>
        <div class="brush-preset" data-preset="calligraphy" title="Calligraphy">‚úí</div>
        <div class="brush-preset" data-preset="dots" title="Dots">‚ãØ</div>
        <div class="brush-preset" data-preset="splatter" title="Splatter">‚ú±</div>
      </div>
    </div>
    <div class="panel-section" id="shape-options" style="display:none">
      <label>Shape</label>
      <div id="shape-picker">
        <button class="shape-btn active" data-shape="rect">‚ñ≠</button>
        <button class="shape-btn" data-shape="ellipse">‚óØ</button>
        <button class="shape-btn" data-shape="line">‚ï±</button>
        <button class="shape-btn" data-shape="arrow">‚Üí</button>
        <button class="shape-btn" data-shape="triangle">‚ñ≥</button>
        <button class="shape-btn" data-shape="star">‚òÜ</button>
      </div>
      <div class="toggle-row" style="margin-top:8px">
        <label>Fill Shape</label>
        <label class="switch"><input type="checkbox" id="shape-fill"><span class="slider-sw"></span></label>
      </div>
    </div>
  </div>

  <!-- COLOR PANEL -->
  <div id="color-panel" class="panel-content">
    <div class="panel-section">
      <div id="color-swatch-row">
        <div id="color-fg" class="swatch" title="Foreground"></div>
        <div id="color-bg" class="swatch secondary" title="Background"></div>
        <button id="btn-swap-colors" title="Swap">‚áÑ</button>
        <button id="btn-default-colors" title="B&W">‚äô</button>
      </div>
    </div>
    <div class="panel-section" style="text-align:center">
      <canvas id="color-wheel" width="190" height="190"></canvas>
    </div>
    <div class="panel-section">
      <div class="slider-row"><label>H</label><input type="range" id="hue-slider" min="0" max="360" value="0" class="hue-track"><span id="h-val">0</span></div>
      <div class="slider-row"><label>S</label><input type="range" id="sat-slider" min="0" max="100" value="0"><span id="s-val">0</span>%</div>
      <div class="slider-row"><label>L</label><input type="range" id="lit-slider" min="0" max="100" value="0"><span id="l-val">0</span>%</div>
      <div class="slider-row"><label>A</label><input type="range" id="alpha-slider" min="0" max="100" value="100"><span id="a-val">100</span>%</div>
    </div>
    <div class="panel-section hex-row">
      <input type="text" id="hex-input" value="#000000" maxlength="7">
      <input type="color" id="native-color-picker" value="#000000" title="Color Picker">
    </div>
    <div class="panel-section">
      <label>Palette</label>
      <div id="color-palette"></div>
      <button id="btn-add-palette" class="small-btn">+ Add Color</button>
    </div>
    <div class="panel-section">
      <label>Recent</label>
      <div id="color-history"></div>
    </div>
  </div>

  <!-- LAYERS PANEL -->
  <div id="layers-panel" class="panel-content">
    <div class="layers-toolbar">
      <button id="btn-add-layer">+</button>
      <button id="btn-dupe-layer">‚éò</button>
      <button id="btn-merge-down">‚Üì</button>
      <button id="btn-del-layer">üóë</button>
      <button id="btn-flatten">‚¨ì</button>
    </div>
    <div id="layers-list"></div>
    <div class="panel-section">
      <label>Opacity <span id="layer-opacity-val">100</span>%</label>
      <input type="range" id="layer-opacity" min="0" max="100" value="100">
    </div>
    <div class="panel-section">
      <label>Blend Mode</label>
      <select id="layer-blend-mode">
        <option value="source-over">Normal</option>
        <option value="multiply">Multiply</option>
        <option value="screen">Screen</option>
        <option value="overlay">Overlay</option>
        <option value="soft-light">Soft Light</option>
        <option value="hard-light">Hard Light</option>
        <option value="darken">Darken</option>
        <option value="lighten">Lighten</option>
        <option value="difference">Difference</option>
        <option value="color-dodge">Color Dodge</option>
        <option value="color-burn">Color Burn</option>
      </select>
    </div>
    <div class="panel-section toggle-row">
      <label>Lock Layer</label>
      <label class="switch"><input type="checkbox" id="layer-lock"><span class="slider-sw"></span></label>
    </div>
  </div>

  <!-- REFERENCE PANEL -->
  <div id="reference-panel" class="panel-content">
    <div class="panel-section">
      <button id="btn-load-reference" class="full-btn">üìÇ Load Reference Image</button>
      <input type="file" id="reference-file" accept="image/*" style="display:none">
    </div>
    <div class="panel-section">
      <label>Opacity <span id="ref-opacity-val">80</span>%</label>
      <input type="range" id="ref-opacity" min="10" max="100" value="80">
    </div>
    <div class="panel-section toggle-row">
      <label>Visible</label>
      <label class="switch"><input type="checkbox" id="ref-visible" checked><span class="slider-sw"></span></label>
    </div>
    <div class="panel-section toggle-row">
      <label>Flip H</label>
      <label class="switch"><input type="checkbox" id="ref-flip-h"><span class="slider-sw"></span></label>
    </div>
    <div class="panel-section toggle-row">
      <label>Flip V</label>
      <label class="switch"><input type="checkbox" id="ref-flip-v"><span class="slider-sw"></span></label>
    </div>
    <div class="panel-section toggle-row">
      <label>Grayscale</label>
      <label class="switch"><input type="checkbox" id="ref-gray"><span class="slider-sw"></span></label>
    </div>
    <div class="panel-section">
      <label>Size <span id="ref-size-val">40</span>%</label>
      <input type="range" id="ref-size" min="10" max="100" value="40">
    </div>
    <div id="reference-preview-wrap">
      <img id="reference-preview" alt="Reference" style="display:none">
    </div>
    <div class="panel-section">
      <small>Drag reference on canvas to reposition.</small>
    </div>
  </div>
</aside>

<main id="canvas-area">
  <div id="canvas-wrapper">
    <canvas id="main-canvas"></canvas>
    <canvas id="overlay-canvas"></canvas>
    <canvas id="grid-canvas"></canvas>
    <canvas id="selection-canvas"></canvas>
    <div id="reference-overlay">
      <img id="ref-img" alt="" draggable="false">
      <div id="ref-handle">‚§°</div>
    </div>
    <div id="symmetry-guide"></div>
    <div id="text-overlay" style="display:none">
      <textarea id="text-input" placeholder="Type here..."></textarea>
      <div class="text-controls">
        <select id="text-font">
          <option>Arial</option><option>Georgia</option><option>Courier New</option>
          <option>Helvetica</option><option>Times New Roman</option><option>Verdana</option>
        </select>
        <input type="number" id="text-size" value="32" min="8" max="400">
        <button id="text-bold">B</button>
        <button id="text-italic">I</button>
        <button id="text-confirm">‚úì</button>
        <button id="text-cancel">‚úï</button>
      </div>
    </div>
  </div>
</main>

<footer id="toolbar-bottom">
  <div class="bottom-group">
    <select id="canvas-size-preset">
      <option value="2048x2732">iPad Pro 12.9"</option>
      <option value="1668x2224">iPad Air</option>
      <option value="1536x2048">iPad</option>
      <option value="3000x3000">Square 3K</option>
      <option value="4096x4096">Square 4K</option>
      <option value="1920x1080">1080p HD</option>
      <option value="3840x2160">4K UHD</option>
      <option value="custom">Custom‚Ä¶</option>
    </select>
  </div>
  <div class="bottom-group">
    <button class="tool-btn toggle-btn" id="btn-pencil-only" title="Pencil Only">‚úèÔ∏è Pencil Only</button>
    <button class="tool-btn toggle-btn" id="btn-smoothing" title="Stroke Smoothing">„Äú Smooth</button>
    <button class="tool-btn" id="btn-clear">‚å´ Clear</button>
  </div>
  <div class="bottom-group" id="status-bar">
    <span id="coords-display">x:0 y:0</span>
    <span id="pressure-display">‚¨§ 0.00</span>
    <span id="tilt-display">‚Üó 0¬∞</span>
    <span id="layer-count">1 layer</span>
  </div>
</footer>

<!-- MODALS -->
<div id="modal-backdrop" style="display:none">
  <div id="modal-custom-size" class="modal">
    <h3>Custom Canvas Size</h3>
    <label>Width (px)<br><input type="number" id="custom-w" value="2048" min="100" max="8192"></label>
    <label>Height (px)<br><input type="number" id="custom-h" value="2732" min="100" max="8192"></label>
    <div class="modal-btns">
      <button id="modal-cancel">Cancel</button>
      <button id="modal-ok">Create</button>
    </div>
  </div>
</div>

<div id="context-menu">
  <div class="ctx-item" id="ctx-copy">Copy Layer</div>
  <div class="ctx-item" id="ctx-paste">Paste</div>
  <div class="ctx-item" id="ctx-fill">Fill Selection</div>
  <div class="ctx-item" id="ctx-clear-sel">Clear Selection</div>
  <div class="ctx-item" id="ctx-deselect">Deselect</div>
</div>

<div id="toast"></div>

<script src="app.js"></script>
</body>
</html>
